<?xml version="1.0" encoding="utf-8"?>
<s:Window xmlns:fx="http://ns.adobe.com/mxml/2009" 
		  xmlns:s="library://ns.adobe.com/flex/spark" 
		  xmlns:mx="library://ns.adobe.com/flex/mx" 
		  title="Video Viewer"
		  width="500" height="498"
		  backgroundColor="#faeed1"
		  creationComplete="initializeApp()">
	<s:layout>
		<s:BasicLayout/>
	</s:layout>
	<fx:Script>
		<![CDATA[
			import dataTypes.place.*;
			
			import flash.filesystem.File;
			
			import mx.controls.Alert;
			
			public var videoFile:File;
			
			[Bindable]
			protected var videoURL:String;
			
			protected function initializeApp():void {
				this.move(800, 200);
			}
			
			protected function openVideoButton_clickHandler(event:MouseEvent):void
			{
				// Open video
				try {
					videoFile = new File();
					var filter:FileFilter = new FileFilter("Video File", "*.*");
					videoFile.addEventListener(Event.SELECT, openVideoFile);
					videoFile.browseForOpen("Open video file", [filter]);
					//videoFile.addEventListener(Event.CANCEL, openVideoClose);

				} catch (error:IOError) {
					Alert.show(error.message);
				}
			}
			
			private function openVideoClose(event:Event):void {
			}
			
			private function openVideoFile(event:Event):void 
			{
				//Set parameters
				videoFileLabel.text = videoFile.name;
				videoURL = videoFile.url;
			}	
			
			public function displayAttributeValue(_videoURL:VideoURL): void {
				var videoURLdata:URL = _videoURL as URL;
				var vFile:File = new File(videoURLdata.value);
				videoFileLabel.text = vFile.name;
				videoURL = videoURLdata.value;
			}
			
			// Text and instruction  Controls
			protected function text_jp_clickHandler(event:MouseEvent):void
			{
				var request:URLRequest = new URLRequest("documents/jp/videoViewer_jp.html");
				navigateToURL(request);
			}
			
			protected function text_en_clickHandler(event:MouseEvent):void
			{
				var request:URLRequest = new URLRequest("documents/en/videoViewer_en.html");
				navigateToURL(request);
			}
			
			protected function volumeSlider_changeHandler(event:Event):void
			{
				if (videoView != null) videoView.volume = volumeSlider.value;
			}

			protected function startButton_clickHandler(event:MouseEvent):void
			{
				if (videoView != null) {
					videoView.play();
					videoView.volume = volumeSlider.value;
				}
			}
			
			protected function pauseButton_clickHandler(event:MouseEvent):void
			{
				if (videoView != null) {
					if (pauseButton.label == "pause") {
						pauseButton.label = "restart";
						videoView.pause();
					}
					else {
						pauseButton.label = "pause";
						videoView.play();
						videoView.volume = volumeSlider.value;
					}
				}
			}
			
			protected function stopButton_clickHandler(event:MouseEvent):void
			{
				videoView.stop();
			}
			
		]]>
	</fx:Script>
	
	<fx:Declarations>
		<!-- 非ビジュアルエレメント (サービス、値オブジェクトなど) をここに配置 -->
	</fx:Declarations>
	<mx:Image x="10" y="10" source="@Embed('images/pictAcquisition1.png')" width="50" height="50"/>
	<s:VideoDisplay x="69" y="115" width="360" height="240" id="videoView" autoPlay="false"  source="{videoURL}"/>
	<s:HGroup x="147" y="374" width="208" height="24">
	</s:HGroup>
	<s:Label x="286" y="69" id="videoFileLabel" backgroundColor="#DADADA" width="135" height="24" verticalAlign="middle"/>
	<s:Button x="287" y="43" label="open" width="57" id="openVideoButton" click="openVideoButton_clickHandler(event)" />
	<s:Label x="350" y="49" text="Video"/>
	<s:Label x="406" y="10" text="日本語" fontFamily="Osaka" color="#969696" fontSize="11"
			 buttonMode="true" click="text_jp_clickHandler(event)"/>
	<s:Label x="447" y="12" text="English" color="#969696"
			 buttonMode="true" click="text_en_clickHandler(event)"/>
	<s:Label x="232" y="407" fontSize="10" text="Volume"/>
	<s:HSlider id="volumeSlider" x="216" y="425" width="67"
			   change="volumeSlider_changeHandler(event)" maximum="1.0" minimum="0.0"
			   stepSize="0.01" value="0.5"/>
	<s:Label x="76" y="15" text="Video Viewer " fontSize="16"/>
	<s:Button id="startButton" x="158" y="374" width="54" label="start"
			  click="startButton_clickHandler(event)"/>
	<s:Button id="pauseButton" x="218" y="374" width="60" label="pause"
			  click="pauseButton_clickHandler(event)"/>
	<s:Button id="stopButton" x="284" y="374" width="58" label="stop"
			  click="stopButton_clickHandler(event)"/>

</s:Window>
